package com.vegaasen.exploit.heartbleed.util;

import org.junit.Before;
import org.junit.Test;

import static org.junit.Assert.assertEquals;
import static org.junit.Assert.assertNotNull;

/**
 * @author <a href="vegaasen@gmail.com">vegardaasen</a>
 */
public final class RadixUtilsTest {

    private static final String UTF_8 = "UTF-8";

    @Before
    public void setUp() {
        RadixUtils.setEncoding(UTF_8);
    }

    @Test
    public void bytesToHex_withoutEncoding_ok() {
        final String result = RadixUtils.getEncoding();
        assertNotNull(result);
        assertEquals(UTF_8, result);
    }

    @Test
    public void bytesToHex_withEncoding_ok() {
        final String encoding = "ISO-8859-1";
        RadixUtils.setEncoding(encoding);
        final String result = RadixUtils.getEncoding();
        assertNotNull(result);
        assertEquals(encoding, result);
    }

    @Test(expected = IllegalArgumentException.class)
    public void bytesToHex_nilled_fail() {
        RadixUtils.bytesToHex(null);
    }

    @Test(expected = IllegalArgumentException.class)
    public void bytesToHex_empty_fail() {
        RadixUtils.bytesToHex(new byte[0]);
    }

}
