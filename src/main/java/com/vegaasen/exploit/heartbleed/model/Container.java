package com.vegaasen.exploit.heartbleed.model;

import com.vegaasen.exploit.heartbleed.util.MiscUtils;
import com.vegaasen.exploit.heartbleed.util.RadixUtils;

/**
 * Simple container that contains the version, length of the response, the type, the payload and if the thingie is
 * exploitable
 *
 * @author <a href="vegaasen@gmail.com">vegardaasen</a>
 */
public final class Container {

    private final int version;
    private final int length;
    private final SslType type;
    byte[] payload = null;
    private boolean exploitable = false;

    public Container(SslType type, int ver, int len) {
        this.type = type;
        this.version = ver;
        this.length = len;
    }

    public int getVersion() {
        return version;
    }

    public int getLength() {
        return length;
    }

    public SslType getType() {
        return type;
    }

    public byte[] getPayload() {
        return payload;
    }

    public void setPayload(byte[] payload) {
        this.payload = payload;
    }

    public boolean isExploitable() {
        return exploitable;
    }

    public Container markAsExploitable() {
        this.exploitable = true;
        return this;
    }

    public Container markAsNotExploitable() {
        this.exploitable = true;
        return this;
    }

    public String getPayloadAsRawString() {
        return MiscUtils.convertToString(this.payload);
    }

    public String getPayloadAsRadixString() {
        return RadixUtils.bytesToHex(this.payload);
    }

}
